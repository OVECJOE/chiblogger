"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[624],{3624:function(e,n,t){t.r(n),t.d(n,{default:function(){return f}});var s=t(4942),a=t(1413),o=t(885),r=t(6355),i=t(2791),c=t(4569),u=t.n(c),l=t(5928),d=t(4335),p=t(4457),h=t(184),f=function(){var e=(0,i.useContext)(l.S),n=e.userData,t=e.userDispatcher,c=(0,i.useContext)(d.x).projectDispatcher,f=(0,i.useState)(!0),m=(0,o.Z)(f,2),v=m[0],w=m[1],x=(0,i.useState)({state:!1,newPassword:"",confirmPassword:""}),g=(0,o.Z)(x,2),j=g[0],P=g[1],C=(0,i.useState)(!1),E=(0,o.Z)(C,2),S=E[0],y=E[1],_=(0,i.useState)({}),b=(0,o.Z)(_,2),R=b[0],T=b[1],D=function(e){var n=e.target,t=n.name,o=n.value;P((function(e){return(0,a.Z)((0,a.Z)({},e),{},(0,s.Z)({},t,o))}))},O=function(e){(0,p.bv)(e,t)};return(0,h.jsxs)("section",{className:"profile-section",children:[S&&(0,h.jsxs)("form",{className:"select-photo-card",onSubmit:function(e){e.preventDefault(),(0,p.Ix)(R,t,c).then((function(e){console.log(e),u().post("/api/users/upload-photo",{photo:e},{headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(n.token)}}).then((function(e){t({type:"STORE_USER",user:e.data}),y(!1)})).catch((function(e){(0,p.GW)(e,c)}))})).catch((function(e){(0,p.GW)(e,c)}))},children:[(0,h.jsx)("label",{htmlFor:"select-photo",children:"Select a photo:"}),(0,h.jsx)("input",{type:"file",accept:"image/png, image/jpeg",onChange:function(e){var n=e.target.files[0];T(n)}}),(0,h.jsx)("button",{children:"Upload"})]}),(0,h.jsxs)("div",{className:"profile-pic",children:[n.photo?(0,h.jsx)("img",{src:n.photo,alt:n.username}):(0,h.jsx)("div",{className:"no-photo",children:n.username&&n.username[0].toUpperCase()}),(0,h.jsx)(r.ffH,{onClick:function(){return y(!0)}})]}),(0,h.jsxs)("div",{className:"profile-info",children:[(0,h.jsxs)("span",{className:"input-edit",children:[v?"View":"Edit"," Mode ",(0,h.jsx)(r.ffH,{onClick:function(){return w((function(e){return!e}))}})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"username",children:"Username"}),(0,h.jsx)("div",{className:"edit-box",children:(0,h.jsx)("input",{type:"text",name:"username",value:n.username,onChange:O,disabled:v})})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("label",{htmlFor:"email",children:"Email"}),(0,h.jsx)("div",{className:"edit-box",children:(0,h.jsx)("input",{type:"email",name:"email",value:n.email,onChange:O,disabled:v})})]}),(0,h.jsx)("hr",{}),(0,h.jsxs)("div",{className:"pass-edit",children:[!j.state&&(0,h.jsx)("div",{className:"disable-pass-edit",children:(0,h.jsx)(r.ffH,{onClick:function(){return P((function(e){return(0,a.Z)((0,a.Z)({},e),{},{state:!e.state})}))}})}),(0,h.jsx)("label",{htmlFor:"new-password",children:"New Password"}),(0,h.jsx)("input",{type:"password",name:"newPassword",placeholder:"Enter New Password",onChange:D,value:j.newPassword,id:"new-password"}),(0,h.jsx)("label",{htmlFor:"confirm-password",children:"Confirm Password"}),(0,h.jsx)("input",{type:"password",name:"confirmPassword",placeholder:"Confirm New Password",onChange:D,value:j.confirmPassword,id:"confirm-password"})]})]}),(0,h.jsx)("button",{onClick:function(){var e=Object.values(j).every((function(e){return e})),s={username:n.username,email:n.email};if(e){if(j.newPassword!==j.confirmPassword){return void(0,p.GW)({message:"Given passwords not equal"},c)}s.password=j.newPassword}u().post("/api/users/update-admin",s,{headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(n.token)}}).then((function(e){t({type:"STORE_USER",user:e.data})})).catch((function(e){(0,p.GW)(e,c)})),P({state:!1,newPassword:"",confirmPassword:""}),setTimeout((function(){c({type:"REMOVE_ERROR"})}),4e3)},children:"Save Changes"})]})}},4457:function(e,n,t){t.d(n,{GW:function(){return c},Ix:function(){return u},bv:function(){return i},uo:function(){return l}});var s=t(4165),a=t(5861),o=t(4569),r=t.n(o),i=function(e,n){var t=e.target;n({type:"UPDATE_PROPERTY",key:t.name,value:t.value})},c=function(e,n){var t=[];e&&e.response&&(e.response.data&&e.response.data instanceof Array?t=e.response.data:e.response.statusText&&t.push(e.response.statusText)),e.message&&0===t.length&&t.push(e.message),n({type:"SET_ERROR",errors:t})},u=function(){var e=(0,a.Z)((0,s.Z)().mark((function e(n,t,a){var o,i,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_UPLOAD_IMAGE_URL,(i=new FormData).append("file",n),i.append("upload_preset","chiblogger"),i.append("cloud_name","ovecjoe"),e.prev=5,e.next=8,r().post(o,i);case 8:return u=e.sent,t({type:"UPDATE_PHOTO",photoUrl:u.data.url}),e.abrupt("return",u.data.url);case 13:e.prev=13,e.t0=e.catch(5),c(e.t0,a);case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(n,t,s){return e.apply(this,arguments)}}(),l=function(e){var n=new Date(e),t=new Date,s=t.getFullYear()-n.getFullYear();return s?"".concat(s," years ago"):(s=t.getMonth()-n.getMonth())?"".concat(s," months ago"):(s=t.getDay()-n.getDay())?"".concat(s," days ago"):(s=t.getHours()-n.getHours())?"".concat(s," hours ago"):(s=t.getMinutes()-n.getMinutes())?"".concat(s," minutes ago"):(s=t.getSeconds()-n.getSeconds(),"".concat(s," seconds ago"))}}}]);
//# sourceMappingURL=624.97ed4e07.chunk.js.map