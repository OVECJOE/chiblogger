"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[906],{1906:function(e,t,n){n.r(t),n.d(t,{default:function(){return v}});var a=n(885),i=n(2791),o=n(6871),c=n(8617),s=n(4569),r=n.n(s),u=n(4335),l=n(413),d=n(5928),f=n(4457);var h=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:250,c=(0,i.useState)(0),s=(0,a.Z)(c,2),r=s[0],u=s[1];return(0,i.useEffect)((function(){var a=setTimeout((function(){1===r&&e(n),u(0)}),o);return 2===r&&t(n),function(){return clearTimeout(a)}}),[r,n]),function(){return u((function(e){return e+1}))}},p=n(184),v=function(){var e=(0,i.useContext)(l.c),t=e.notifications,n=e.notificationsDispatcher,s=(0,i.useContext)(u.x).projectDispatcher,v=(0,i.useContext)(d.S).userData,m=(0,o.s0)(),g=(0,i.useState)([]),x=(0,a.Z)(g,2),S=x[0],N=x[1],T=(0,i.useState)(""),_=(0,a.Z)(T,2),j=_[0],w=_[1],E=(0,i.useState)(""),y=(0,a.Z)(E,2),C=y[0],A=y[1],D={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(v.token)}},O=function(e){return w(e.target.value)},k=h((function(e){r().put("/api/notifications/".concat(e,"/view"),{},D).then((function(t){n({type:"UPDATE_NOTIFICATION",notification:t.data}),m("/dashboard/notifications/".concat(e))})).catch((function(e){return(0,f.GW)(e,s)}))}),(function(e){r().delete("/api/notifications/".concat(e),D).then((function(t){n({type:"REMOVE_NOTIFICATION",id:t.data._id}),s({type:"SET_MESSAGE",message:"Successfully Deleted Notification with ID ".concat(e,"!")})})).catch((function(e){return(0,f.GW)(e,s)}))}),C);return(0,i.useEffect)((function(){switch(j){case"":N(t);break;case"viewed":N(t.filter((function(e){return e.viewed})));break;case"unread":N(t.filter((function(e){return!e.viewed})));break;default:try{var e=t.filter((function(e){return function(e,t){var n,a,i,o,c=t.toLowerCase();return(null===(n=e.message.toLowerCase().match(c))||void 0===n?void 0:n.length)>0||(null===(a=e.firstName.toLowerCase().match(c))||void 0===a?void 0:a.length)>0||(null===(i=e.email.toLowerCase().match(c))||void 0===i?void 0:i.length)>0||(null===(o=e.dateSent.toLowerCase().match(c))||void 0===o?void 0:o.length)>0}(e,j)}));N(e)}catch(n){(0,f.GW)(n,s)}}}),[j,t]),(0,p.jsxs)("section",{className:"notifications-container",children:[(0,p.jsxs)("div",{className:"inbox-filter-card",children:[(0,p.jsx)("h1",{children:"Notifications"}),(0,p.jsxs)("form",{className:"filter-box",children:[(0,p.jsx)("input",{type:"search",placeholder:"Filter Notification by Keyword...",name:"keyword",value:j,onChange:O}),(0,p.jsxs)("select",{name:"keyword",onChange:O,value:j,children:[(0,p.jsx)("option",{value:"",children:"All"}),(0,p.jsx)("option",{value:"unread",children:"Unread"}),(0,p.jsx)("option",{value:"viewed",children:"Viewed"})]})]})]}),(0,p.jsxs)("p",{className:"notification-count",children:[(0,p.jsx)("span",{children:S.length})," ","Notifications"]}),(0,p.jsx)("p",{className:"tooltip",children:"Click or tap on a notification to view more details about it; Double click or tap to delete"}),(0,p.jsxs)("div",{className:"notifications-list",children:[S.map((function(e){return(0,p.jsxs)("article",{className:"notification-card ".concat(!e.viewed&&"unread"),onClick:function(){A(e._id),k()},children:[(0,p.jsxs)("div",{className:"sender-info",children:[(0,p.jsx)("span",{className:"name",children:e.firstName}),(0,p.jsx)("a",{href:"mailto:".concat(e.email),className:"email",children:e.email})]}),(0,p.jsx)("blockquote",{className:"message-summary",children:e.message}),(0,p.jsxs)("time",{children:["".concat(e.dateSent.split("T")[0]," | "),e.dateSent.split("T")[1].split(".")[0].slice(0,5)]})]},e._id)})),!S.length&&(0,p.jsxs)("p",{className:"no-notification",children:["No ",(0,p.jsx)("span",{className:"highlighted-text",children:"viewed"===j||"unread"===j?"".concat(j," "):""})," notifications."]})]}),(0,p.jsx)("div",{className:"refresh-btn",onClick:function(){r().get("/api/notifications",D).then((function(e){e.data.length!==t.length&&(n({type:"SAVE_ALL_NOTIFICATIONS",notifications:e.data}),s({type:"SET_MESSAGE",message:"Refreshed Successfully."}))})).catch((function(e){(0,f.GW)(e,s)}))},children:(0,p.jsx)(c.lgS,{})})]})}},4457:function(e,t,n){n.d(t,{GW:function(){return r},Ix:function(){return u},bv:function(){return s},uo:function(){return l}});var a=n(4165),i=n(5861),o=n(4569),c=n.n(o),s=function(e,t){var n=e.target;t({type:"UPDATE_PROPERTY",key:n.name,value:n.value})},r=function(e,t){var n=[];e&&e.response&&(e.response.data&&e.response.data instanceof Array?n=e.response.data:e.response.statusText&&n.push(e.response.statusText)),e.message&&0===n.length&&n.push(e.message),t({type:"SET_ERROR",errors:n})},u=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t,n,i){var o,s,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_UPLOAD_IMAGE_URL,(s=new FormData).append("file",t),s.append("upload_preset","chiblogger"),s.append("cloud_name","ovecjoe"),e.prev=5,e.next=8,c().post(o,s);case 8:return u=e.sent,n({type:"UPDATE_PHOTO",photoUrl:u.data.url}),e.abrupt("return",u.data.url);case 13:e.prev=13,e.t0=e.catch(5),r(e.t0,i);case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t,n,a){return e.apply(this,arguments)}}(),l=function(e){var t=new Date(e),n=new Date,a=n.getFullYear()-t.getFullYear();return a?"".concat(a," years ago"):(a=n.getMonth()-t.getMonth())?"".concat(a," months ago"):(a=n.getDay()-t.getDay())?"".concat(a," days ago"):(a=n.getHours()-t.getHours())?"".concat(a," hours ago"):(a=n.getMinutes()-t.getMinutes())?"".concat(a," minutes ago"):(a=n.getSeconds()-t.getSeconds(),"".concat(a," seconds ago"))}}}]);
//# sourceMappingURL=906.4145f145.chunk.js.map